{% extends "base_generic.html" %}

{% block content %}
    <h4>{{ qr.title }}</h4>

    {% if qr.is_shop %}
        {# <p></p><strong>Puntos: {{ qr.scoring_value }}</strong></p> #}
        <br>
        <img src="/static/img/qr/comercios.jpg" alt="Comercio colaborador">
        <br>
        <div class="Description">
            <p>Los Comercios Colaboradores son el principal ingreso de la Festa Major. Sin ellos, las fiestas no serían posibles tal y como las conocemos.</p>
            <p>Por eso, cuando compras en los comercios del barrio, estás colaborando con la Festa Major.</p>
            <p style="text-align: left;">Además:
                - Son nuestros vecinos y vecinas
                - Ofrecen un trato personal y cercano
                - Sufren la competencia de las grandes superficies y el comercio electrónico
                - Un barrio sin comercios es un barrio muerto
            </p>
        </div>
    {% else %}
        {# <p></p><strong>Puntos: {{ qr.scoring_value }} - Pistas: {{ qr.hints }}</strong></p> #}

        {% if not qr.is_scanned %}
            <p class="Justify">{{ qr.hint|safe }}</p>
        {% endif %}

        {% if qr.is_scanned or qr.hints > 0 %}
            <br>
            <figure>
                <img src="/static/{{ qr.image}}" alt="{{ qr.title }}">
                <figcaption>{{ qr.image_footer }}</figcaption>
            </figure>
            <br>
        {% endif %}

        {% if qr.is_scanned %}
            <div class="Description">
                {{ qr.description|safe|urlize }}
            </div>
        {% else %}
            {% if qr.hints > 1 %}
                Pulsa <a class="MapUrl" href="https://maps.google.com/maps?hl=es&amp;q={{ qr.coordinates }}&amp;ie=UTF8&amp;t=&amp;z=17&amp;iwloc=near">aquí</a> para para ampliar el mapa
                <div class="GoogleMapsContainer">
                    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d747.7219631366111!2d2.179371829275129!3d41.44165500403614!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x0!2zNDHCsDI2JzMwLjAiTiAywrAxMCc0Ny43IkU!5e0!3m2!1ses!2ses!4v1622057572627!5m2!1ses!2ses" width="400" height="300" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                </div>
            {% endif %}
        {% endif %}
    {% endif %}

    <div>
        <div class="ButtonsContainer">
            {% if qr.is_shop is not True and qr.is_scanned is not True %}
                {% if qr.hints < 2 %}
                    <form action="{% url 'get-hint' qr.id %}">
                        <input class="Button" type="submit" value="Abrir pista*"/>
                    </form>
                {% else %}
                    <form action="{% url 'get-hint' qr.id %}">
                        <input class="Button" type="submit" value="Resolver QR*"/>
                    </form>
                {% endif %}
            {% endif %}

            <form action="{% url 'qrs' %}">
                <input class="Button" type="submit" value="Ver QRs"/>
            </form>
        </div>

        {% if qr.is_shop is not True and qr.is_scanned is not True %}
            <div class="Warning Center">
                {% if qr.hints < 2 %}
                    * Cada pista resta 1 punto al QR
                {% else %}
                    * Si resuelves el QR no se obtendrán puntos
                {% endif %}
            </div>
        {% endif %}
    </div>

{% endblock %}
